<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>node_32d82be5-4434-4dba-9c5f-da801dbb6467_8aaea4b2</title>

            <script src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS_HTML"></script>
            
<style>
/* minimal styling â€” adjust as needed */
body{font-family:system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;line-height:1.6;margin:1rem;max-width:900px;color:#111}
</style>
</head>
<body>
<div id="xls-tabs" style="margin-bottom:8px;"></div>
<div id="xls-container"></div>

<script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
<script>
(async () => {
  const FILE_PATH = '/uploader/download/http://192.168.1.6:5000/uploader/download/REINSURANCE_ENTRIES20251112-20251112-121616-fb699fa8.xlsx';

  try {
    // If same-origin, cookies are sent automatically.
    // If CROSS-origin, uncomment credentials and set proper CORS headers on the server:
    //   Access-Control-Allow-Origin: https://yourapp.example
    //   Access-Control-Allow-Credentials: true
    const res = await fetch(FILE_PATH /*, { credentials: 'include' }*/);
    if (!res.ok) throw new Error(`HTTP ${res.status} fetching ${FILE_PATH}`);

    const buf = await res.arrayBuffer();
    const wb = XLSX.read(buf, { type: 'array' });

    // Build simple tabs for each sheet
    const tabs = document.getElementById('xls-tabs');
    const container = document.getElementById('xls-container');
    tabs.innerHTML = '';
    container.innerHTML = '';

    function renderSheet(name) {
      const sheet = wb.Sheets[name];
      const html = XLSX.utils.sheet_to_html(sheet, { id: "excel-table", editable: false });
      container.innerHTML = html;
    }

    wb.SheetNames.forEach((name, idx) => {
      const btn = document.createElement('button');
      btn.textContent = name;
      btn.style.cssText = 'margin-right:6px;padding:6px 10px;border:1px solid #ddd;border-radius:8px;cursor:pointer;background:#f7f7f7';
      btn.addEventListener('click', () => renderSheet(name));
      tabs.appendChild(btn);
      if (idx === 0) renderSheet(name);
    });
  } catch (err) {
    console.error(err);
    document.getElementById('xls-container').textContent =
      'Failed to load spreadsheet. Check the network path, CORS, and server headers.';
  }
})();
</script>

</body>
</html>